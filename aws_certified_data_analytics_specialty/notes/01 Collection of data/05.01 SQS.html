
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>What is it &#8212; Knowledge Repository 0.1 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    <no title>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Kinesis Data Streams
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00%20Certification/00%20cerfification%20info.html">
   DAS-C01 certification info
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.02%20Kinesis%20Data%20Streams.html">
   Kinesis Data Streams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.04%20Kinesis%20Data%20Streams%20-%20consumers.html">
   Consumers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.05%20Kinesis%20Data%20Streams%20Scaling.html">
   Scaling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.06%20Kinesis%20Data%20Streams%20-%20handling%20duplicates.html">
   Handling duplicates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.07%20Kinesis%20Data%20Streams%20Security.html">
   Security
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.01%20Kinesis%20Data%20Firehose.html">
   Kinesis Data Firehose
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/michalgromiec/knowledge-repository"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/michalgromiec/knowledge-repository/edit/master/docs/source/aws_certified_data_analytics_specialty/notes/01 Collection of data/05.01 SQS.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   What is it
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-produce-message">
   How to produce message
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-consume-message">
   How to consume message
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fifo-queue">
   FIFO queue
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visibility-timeout">
   Visibility timeout
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#delivery-delay">
   Delivery Delay
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#receive-message-wait-time">
   Receive message wait time
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dead-letter-queues">
   Dead-letter queues
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sqs-extended-client">
   SQS extended client
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-cases">
   Use cases
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pricing">
   Pricing
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#security">
   Security
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#differences-to-kinesis">
   Differences to Kinesis
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sqs-use-cases">
     SQS use cases
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kinesis-data-streams-use-cases">
     Kinesis Data Streams use cases:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to">
   How to…
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#send-message-to-queue">
     Send message to queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieve-message-from-queue">
     Retrieve message from queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#delete-message-from-queue">
     Delete message from queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manually-move-message-to-dead-letter-queue">
     Manually move message to dead-letter queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-number-of-messages-in-queue">
     Get number of messages in queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-number-of-processed-messages-for-queue">
     Get number of processed messages for queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-data-of-oldest-and-the-newest-message-in-queue">
     Get data of oldest and the newest message in queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-if-message-is-present-in-queue-based-on-body">
     Check if message is present in queue (based on body)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-number-of-processing-time-of-waiting-messages-and-calculate-histogram">
     Get number of processing time of waiting messages and calculate histogram
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-how-many-times-message-were-consumed-by-consumers-tries">
     Get how many times message were consumed by consumers (tries)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-all-queue-attributes-in-one-request">
     Get all queue attributes in one request
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#purge-queues">
     Purge queues
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>What is it</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   What is it
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-produce-message">
   How to produce message
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-consume-message">
   How to consume message
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fifo-queue">
   FIFO queue
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visibility-timeout">
   Visibility timeout
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#delivery-delay">
   Delivery Delay
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#receive-message-wait-time">
   Receive message wait time
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dead-letter-queues">
   Dead-letter queues
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sqs-extended-client">
   SQS extended client
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-cases">
   Use cases
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pricing">
   Pricing
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#security">
   Security
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#differences-to-kinesis">
   Differences to Kinesis
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sqs-use-cases">
     SQS use cases
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kinesis-data-streams-use-cases">
     Kinesis Data Streams use cases:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to">
   How to…
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#send-message-to-queue">
     Send message to queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieve-message-from-queue">
     Retrieve message from queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#delete-message-from-queue">
     Delete message from queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manually-move-message-to-dead-letter-queue">
     Manually move message to dead-letter queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-number-of-messages-in-queue">
     Get number of messages in queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-number-of-processed-messages-for-queue">
     Get number of processed messages for queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-data-of-oldest-and-the-newest-message-in-queue">
     Get data of oldest and the newest message in queue
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-if-message-is-present-in-queue-based-on-body">
     Check if message is present in queue (based on body)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-number-of-processing-time-of-waiting-messages-and-calculate-histogram">
     Get number of processing time of waiting messages and calculate histogram
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-how-many-times-message-were-consumed-by-consumers-tries">
     Get how many times message were consumed by consumers (tries)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-all-queue-attributes-in-one-request">
     Get all queue attributes in one request
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#purge-queues">
     Purge queues
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="what-is-it">
<h1>What is it<a class="headerlink" href="#what-is-it" title="Permalink to this heading">#</a></h1>
<p>SQS is a Simple Queue Service.</p>
<p>You can have producers which write to queue and consumers reads from queue.</p>
<ul class="simple">
<li><p>AWS oldest offering (since first version)</p></li>
<li><p>scales from 1 message/second to 10000 per second</p></li>
<li><p>default retention = 4 days, maximum = 14 days, minimum = 1 minute</p></li>
<li><p>extreme low latency (&lt;10ms)</p></li>
<li><p>no messages number limit</p></li>
<li><p>you can add consumers to horizontally scalling solution</p></li>
<li><p>can have duplicate messages (at-least-once-delivery)</p></li>
<li><p>can have out of order messages (best effort ordering)</p></li>
<li><p>limit of message size = 256KB maximum</p></li>
<li><p>by default, sqs queue doesnt take into account order of messages (there is a new type of queue - fifo, which takes it into account)</p></li>
</ul>
</div>
<div class="section" id="how-to-produce-message">
<h1>How to produce message<a class="headerlink" href="#how-to-produce-message" title="Permalink to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Define body (string, up to 256KB of size)</p></li>
<li><p>optionally add metadata (key-value attributes)</p></li>
<li><p>optionally provide delay delivery</p></li>
</ol>
<p>SQS returns:</p>
<ol class="arabic simple">
<li><p>Message identifier</p></li>
<li><p>MD5 hash of the body</p></li>
</ol>
</div>
<div class="section" id="how-to-consume-message">
<h1>How to consume message<a class="headerlink" href="#how-to-consume-message" title="Permalink to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>application polls sqs for messages (receives up to 10 messages at a time)</p></li>
<li><p>application process messages within the visibility timeout</p></li>
<li><p>SQS delete message using message ID</p></li>
</ol>
</div>
<div class="section" id="fifo-queue">
<h1>FIFO queue<a class="headerlink" href="#fifo-queue" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>first-in-first-out</p></li>
<li><p>guarantees order of messages</p></li>
<li><p>lower throughput than the default queue (up to 3000 messages per second with batching or 300 mess/second without batching)</p></li>
<li><p>name of the queue <strong>must</strong> end with <code class="docutils literal notranslate"><span class="pre">.fifo</span></code> suffix</p></li>
</ul>
</div>
<div class="section" id="visibility-timeout">
<h1>Visibility timeout<a class="headerlink" href="#visibility-timeout" title="Permalink to this heading">#</a></h1>
<p>Describes amount of time after which message consumed by consumer and not deleted by consumer are back and available to other consumers. It begins when SQS return a message for consumer.
You should set the visibility timeout to the maximum amount of time that consumer needs to process and delete a message from the queue.
Default = 30 seconds, maximum = 12 hours</p>
</div>
<div class="section" id="delivery-delay">
<h1>Delivery Delay<a class="headerlink" href="#delivery-delay" title="Permalink to this heading">#</a></h1>
<p>Amout of time to delay delivery of message produced by producer to queue. In practce, message send to queue remains invisible to consumers for this duration.
Default = 0 seconds, maximum = 15 minutes</p>
</div>
<div class="section" id="receive-message-wait-time">
<h1>Receive message wait time<a class="headerlink" href="#receive-message-wait-time" title="Permalink to this heading">#</a></h1>
<p>You can delay queue polling processes to reduce the costs. Setting this option helps in getting more items in one request (up to 10 messages) and it eliminates number of empty responses. If a reveive request collects the maximum number of messages, it doesn’t wait for the polling to timeout, it returns batch of results immediately.
Default = 0 seconds, maximum = 20 seconds.</p>
</div>
<div class="section" id="dead-letter-queues">
<h1>Dead-letter queues<a class="headerlink" href="#dead-letter-queues" title="Permalink to this heading">#</a></h1>
<p>You can rewrite messages which can’t be consumed succesfully to separate queue which is called dead-letter queue. Dead-letter queue is not created automatically, you have to create it by yourself. Dead-letter queue type (standard/fifo) must match the source queue.
Message is sent to dead-letter queue when Maximum receive values is exceeded. If the ReceiveCount exceeds this threshold (set up on creating the queue), message is sent do dead-letter queue.
Dead-letter queue must exist within the same AWS account and resides in the same region as the source queue.</p>
</div>
<div class="section" id="sqs-extended-client">
<h1>SQS extended client<a class="headerlink" href="#sqs-extended-client" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>allows for processing objects bigger than 256KB of size</p></li>
<li><p>producer puts object into S3 and add only small metadata message to SQS queue, consumer receives metadata and retrieve large object from S3</p></li>
<li><p>helpful, but not recommended (long time of processing such big objects)</p></li>
</ul>
</div>
<div class="section" id="use-cases">
<h1>Use cases<a class="headerlink" href="#use-cases" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>decouple applications (allow application to be asynchronous)</p></li>
<li><p>buffer writes to database</p></li>
<li><p>handle large loads of messages comming in (for example on peaks for database writes)</p></li>
</ul>
</div>
<div class="section" id="pricing">
<h1>Pricing<a class="headerlink" href="#pricing" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>pay per api request and per network usage</p></li>
</ul>
</div>
<div class="section" id="security">
<h1>Security<a class="headerlink" href="#security" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>encryption in flight by using https endpoints</p></li>
<li><p>encryption at rest by using server side enctyption using KMS</p></li>
<li><p>iam policy must allow usage of sqs in general</p></li>
<li><p>sqs queue access policy can verify if certain role can access to certain queue</p>
<ul>
<li><p>controlled over IP</p></li>
<li><p>controlled over the time the requests come in</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="differences-to-kinesis">
<h1>Differences to Kinesis<a class="headerlink" href="#differences-to-kinesis" title="Permalink to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Message body is string, Kinesis have bytes</p></li>
<li><p>Message size limit is 256KB, Kinesis has 1MB</p></li>
<li><p>As consumers deletes messages when processing done, one SQS message cannot be processed by more than one application, Kinesis doesn’t delete messages so one kinesis stream message can be processed by more than one application or processed more than once</p></li>
<li><p>So in general, data can be consumed once, in Kinesis they can be deleted many times</p></li>
<li><p>and in general, allows for multiple applcations reading from one stream (pub-sub architecture)</p></li>
<li><p>SQS deletes messages when processed by consumer, Kinesis delete only after the retention period</p></li>
<li><p>SQS by default doesnt pay attention on messages order, Kinesis store messages in shards ordered by incoming timestamp</p></li>
<li><p>SQS doesnt have option for checkpointing to store where application finished reading</p></li>
<li><p>SQS have one pricing option similar to kinesis provisioned, kinesis has provisioned/on-demand mode</p></li>
</ol>
<p>In general, we can recognize below use-cases:</p>
<div class="section" id="sqs-use-cases">
<h2>SQS use cases<a class="headerlink" href="#sqs-use-cases" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>processing objects</p></li>
<li><p>application decoupling</p></li>
</ul>
</div>
<div class="section" id="kinesis-data-streams-use-cases">
<h2>Kinesis Data Streams use cases:<a class="headerlink" href="#kinesis-data-streams-use-cases" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>fast data collection and processing</p></li>
<li><p>data capture</p></li>
<li><p>real time data analytics</p></li>
<li><p>complex stream processing</p></li>
</ul>
</div>
</div>
<div class="section" id="how-to">
<h1>How to…<a class="headerlink" href="#how-to" title="Permalink to this heading">#</a></h1>
<div class="section" id="send-message-to-queue">
<h2>Send message to queue<a class="headerlink" href="#send-message-to-queue" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>sqs<span class="w"> </span>send-message<span class="w"> </span>--queue-url<span class="w"> </span>https://sqs.eu-west-1.amazonaws.com/662419442876/test-queue-mg<span class="w"> </span>--message-body<span class="w"> </span><span class="s2">&quot;testowy&quot;</span><span class="w"> </span>--profile<span class="w"> </span>mg-priv
</pre></div>
</div>
</div>
<div class="section" id="retrieve-message-from-queue">
<h2>Retrieve message from queue<a class="headerlink" href="#retrieve-message-from-queue" title="Permalink to this heading">#</a></h2>
<p>Default function, which retrieves one message from queue:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>sqs<span class="w"> </span>receive-message<span class="w"> </span>--queue-url<span class="w"> </span>https://sqs.eu-west-1.amazonaws.com/662419442876/test-queue-mg<span class="w"> </span>--profile<span class="w"> </span>mg-priv
</pre></div>
</div>
<p>By using max-number-of-messages parameter you can retrieve up to 10 messages in one request</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>sqs<span class="w"> </span>receive-message<span class="w"> </span>--queue-url<span class="w"> </span>https://sqs.eu-west-1.amazonaws.com/662419442876/test-queue-mg<span class="w"> </span>--max-number-of-messages<span class="w"> </span><span class="m">10</span><span class="w"> </span>--profile<span class="w"> </span>mg-priv
</pre></div>
</div>
</div>
<div class="section" id="delete-message-from-queue">
<h2>Delete message from queue<a class="headerlink" href="#delete-message-from-queue" title="Permalink to this heading">#</a></h2>
<p>To delete one selected message:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>sqs<span class="w"> </span>delete-message<span class="w"> </span>--receipt-handle<span class="w"> </span>AQEBUjqhol2b6R0OzsWBtONbDhk8wVlnU4bRJsUOnHIorUZZijTXydsOSBKI2+D4MVoPApMp+Dm8Y6T77IwNJan001/wS0GEpMg6eemDnj7IcuiGFlEc1M64YzuqMyirbdPb6ZsDucfethSAxzu7QsIqHjb0L9y9ePUBnDi1JFNHtgUlzRYMUdroP9QaQebAsaSoPkbUmXKqxheAq9EkNDrYN6AYZ8T1VPzpM0Gn/fU7HVMl+40PTwY21hk7H5dWYoE5xd21ug3i8HycxMIfy/2YRE46MmEYJSmK0bPqYJj+7E/Kq/R/UklnTNrIpdlfbojUDcXoo/sBOWrZv57NQ8NyPgiWkfZttqgsrOUvVirLkV+VyrvXQlKmOG/M0tA3Rd0364lCLmWJU/8SvraJM0zKng<span class="o">==</span><span class="w"> </span>--queue-url<span class="w"> </span>https://sqs.eu-west-1.amazonaws.com/662419442876/test-queue-mg
</pre></div>
</div>
<p>You can also delete messages in batch:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>sqs<span class="w"> </span>delete-message-batch<span class="w"> </span>--queue-url<span class="w"> </span>https://sqs.eu-west-1.amazonaws.com/662419442876/test-queue-mg<span class="w"> </span>--entries<span class="w"> </span><span class="s1">&#39;[{&quot;Id&quot;:&quot;msg1&quot;,&quot;ReceiptHandle&quot;:&quot;abc123&quot;},{&quot;Id&quot;:&quot;msg2&quot;,&quot;ReceiptHandle&quot;:&quot;def456&quot;}]&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="manually-move-message-to-dead-letter-queue">
<h2>Manually move message to dead-letter queue<a class="headerlink" href="#manually-move-message-to-dead-letter-queue" title="Permalink to this heading">#</a></h2>
<p>There is no direct option for moving message to dead-letter queue. What you could do is:</p>
<ol class="arabic simple">
<li><p>Receive message data</p></li>
<li><p>Manually put message to dead-letter queue by using aws sqs send-message</p></li>
<li><p>Delete message from source queue</p></li>
</ol>
</div>
<div class="section" id="get-number-of-messages-in-queue">
<h2>Get number of messages in queue<a class="headerlink" href="#get-number-of-messages-in-queue" title="Permalink to this heading">#</a></h2>
<p>You can retrieve <strong>approximate</strong> number of messages waiting for consumption in queue. Approximate because at the end SQS uses a distribute system to process messages, so the actual number of messages in the queue may differ from this number</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>sqs<span class="w"> </span>get-queue-attributes<span class="w"> </span>--queue-url<span class="w"> </span>https://sqs.eu-west-1.amazonaws.com/662419442876/test-queue-mg<span class="w"> </span>--attribute-names<span class="w"> </span>ApproximateNumberOfMessages<span class="w"> </span>--profile<span class="w"> </span>mg-priv
</pre></div>
</div>
</div>
<div class="section" id="get-number-of-processed-messages-for-queue">
<h2>Get number of processed messages for queue<a class="headerlink" href="#get-number-of-processed-messages-for-queue" title="Permalink to this heading">#</a></h2>
<p>It is not possible to get it directly from SQS - this service is only for distribution of messages so it doesn’t store number of processed messages anywhere.</p>
</div>
<div class="section" id="get-data-of-oldest-and-the-newest-message-in-queue">
<h2>Get data of oldest and the newest message in queue<a class="headerlink" href="#get-data-of-oldest-and-the-newest-message-in-queue" title="Permalink to this heading">#</a></h2>
<p>SQS doesn’t support such requests, you can use Cloudwatch metric ApproximateAgeOfOldestMessage to monitor this value</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>cloudwatch<span class="w"> </span>get-metric-statistics<span class="w"> </span>--namespace<span class="w"> </span>AWS/SQS<span class="w"> </span>--metric-name<span class="w"> </span>ApproximateAgeOfOldestMessage<span class="w"> </span>--start-time<span class="w"> </span><span class="m">2022</span>-01-06T17:10:00<span class="w"> </span>--end-time<span class="w"> </span><span class="m">2022</span>-01-06T17:15:00<span class="w"> </span>--period<span class="w"> </span><span class="m">1</span><span class="w"> </span>--profile<span class="w"> </span>mg-priv<span class="w"> </span>--region<span class="w"> </span>eu-central-1<span class="w"> </span>--statistics<span class="w"> </span>Maximum
</pre></div>
</div>
</div>
<div class="section" id="check-if-message-is-present-in-queue-based-on-body">
<h2>Check if message is present in queue (based on body)<a class="headerlink" href="#check-if-message-is-present-in-queue-based-on-body" title="Permalink to this heading">#</a></h2>
<p>(?)</p>
</div>
<div class="section" id="get-number-of-processing-time-of-waiting-messages-and-calculate-histogram">
<h2>Get number of processing time of waiting messages and calculate histogram<a class="headerlink" href="#get-number-of-processing-time-of-waiting-messages-and-calculate-histogram" title="Permalink to this heading">#</a></h2>
<p>(?)</p>
</div>
<div class="section" id="get-how-many-times-message-were-consumed-by-consumers-tries">
<h2>Get how many times message were consumed by consumers (tries)<a class="headerlink" href="#get-how-many-times-message-were-consumed-by-consumers-tries" title="Permalink to this heading">#</a></h2>
<p>There is no direct command to retrieve this number, however it is possible to retrieve message and include this number as an attributes of the response</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>sqs<span class="w"> </span>receive-message<span class="w"> </span>--queue-url<span class="w"> </span>https://sqs.eu-west-1.amazonaws.com/662419442876/test-queue-mg<span class="w"> </span>--attribute-names<span class="w"> </span>All<span class="w"> </span>--profile<span class="w"> </span>mg-priv
</pre></div>
</div>
</div>
<div class="section" id="get-all-queue-attributes-in-one-request">
<h2>Get all queue attributes in one request<a class="headerlink" href="#get-all-queue-attributes-in-one-request" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>sqs<span class="w"> </span>get-queue-attributes<span class="w"> </span>--queue-url<span class="w"> </span>https://sqs.eu-west-1.amazonaws.com/662419442876/test-queue-mg<span class="w"> </span>--attribute-names<span class="w"> </span>All
</pre></div>
</div>
</div>
<div class="section" id="purge-queues">
<h2>Purge queues<a class="headerlink" href="#purge-queues" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aws<span class="w"> </span>sqs<span class="w"> </span>purge-queue<span class="w"> </span>--queue-url<span class="w"> </span>https://sqs.eu-west-1.amazonaws.com/662419442876/test-queue-mg<span class="w"> </span>--profile<span class="w"> </span>mg-priv
</pre></div>
</div>
</div>
</div>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By https://github.com/michalgromiec<br/>
  
      &copy; Copyright .<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>