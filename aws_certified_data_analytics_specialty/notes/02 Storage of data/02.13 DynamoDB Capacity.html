
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Consistency &#8212; Knowledge Repository 0.1 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    <no title>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Kinesis Data Streams
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00%20Certification/00%20cerfification%20info.html">
   DAS-C01 certification info
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01%20Collection%20of%20data/01.02%20Kinesis%20Data%20Streams.html">
   Kinesis Data Streams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01%20Collection%20of%20data/01.04%20Kinesis%20Data%20Streams%20-%20consumers.html">
   Consumers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01%20Collection%20of%20data/01.05%20Kinesis%20Data%20Streams%20Scaling.html">
   Scaling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01%20Collection%20of%20data/01.06%20Kinesis%20Data%20Streams%20-%20handling%20duplicates.html">
   Handling duplicates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01%20Collection%20of%20data/01.07%20Kinesis%20Data%20Streams%20Security.html">
   Security
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01%20Collection%20of%20data/02.01%20Kinesis%20Data%20Firehose.html">
   Kinesis Data Firehose
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/michalgromiec/knowledge-repository"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/michalgromiec/knowledge-repository/edit/master/docs/source/aws_certified_data_analytics_specialty/notes/02 Storage of data/02.13 DynamoDB Capacity.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Consistency
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eventually-consistent-read">
     Eventually Consistent Read
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#strongly-consistent-read">
     Strongly Consistent Read
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dynamodb-partitions-internal">
   DynamoDB partitions internal
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#capacity-modes">
   Capacity modes
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#provision-mode">
     Provision Mode
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#on-demand-mode">
     On-Demand Mode
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#capacity-units">
   Capacity Units
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-capacity-units-throughput-for-reads">
     Read Capacity Units - throughput for reads
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-capacity-units-throughput-for-writes">
     Write Capacity Units - throughput for writes
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Consistency</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Consistency
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eventually-consistent-read">
     Eventually Consistent Read
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#strongly-consistent-read">
     Strongly Consistent Read
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dynamodb-partitions-internal">
   DynamoDB partitions internal
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#capacity-modes">
   Capacity modes
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#provision-mode">
     Provision Mode
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#on-demand-mode">
     On-Demand Mode
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#capacity-units">
   Capacity Units
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-capacity-units-throughput-for-reads">
     Read Capacity Units - throughput for reads
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-capacity-units-throughput-for-writes">
     Write Capacity Units - throughput for writes
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="consistency">
<h1>Consistency<a class="headerlink" href="#consistency" title="Permalink to this heading">#</a></h1>
<div class="section" id="eventually-consistent-read">
<h2>Eventually Consistent Read<a class="headerlink" href="#eventually-consistent-read" title="Permalink to this heading">#</a></h2>
<p>reads data no matter if replicated in full between DynamoDB replicas server (underneath, not visible for users)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One Eventually Consistent Read consumes half of the RCU</p>
</div>
</div>
<div class="section" id="strongly-consistent-read">
<h2>Strongly Consistent Read<a class="headerlink" href="#strongly-consistent-read" title="Permalink to this heading">#</a></h2>
<p>reads only those data which are replicated in full between replicas server</p>
</div>
</div>
<div class="section" id="dynamodb-partitions-internal">
<h1>DynamoDB partitions internal<a class="headerlink" href="#dynamodb-partitions-internal" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>when you write item to dynamodb, dynamodb calculates hash for primary key of written item and based on hash function result decide to which partition record will be written</p></li>
<li><p>hot partition = partition for which the most items are written (mostly because of primary key, not because of hashing function)</p></li>
<li><p>number of partitions depends on provisioned throughput and the size of the items in the table</p>
<ul>
<li><p>the larger provisioned throughput or rager items in table = the more partitions dymanodb creates to store the data</p></li>
<li><p>number of partitions is higher number of two below numbers:</p>
<ul>
<li><p>RCU_total/3000 + WCU_total/1000</p></li>
<li><p>table_size_total/10GB</p></li>
</ul>
</li>
</ul>
</li>
<li><p>dynamodb automatically scales the number of partitions to meet the capacity requirements</p></li>
<li><p>when number of partitions change, data in the table is redistributed across the new partitions (process known as partition split). The aim is to evenly distribute data across the partitions, to encure the highest performance of the table</p></li>
<li><p>parition split can result on increased read and write lantecies (yet it doesn’t consume capacity units, it’s a background process)</p></li>
</ul>
</div>
<div class="section" id="capacity-modes">
<h1>Capacity modes<a class="headerlink" href="#capacity-modes" title="Permalink to this heading">#</a></h1>
<p>There are two modes of capacity/throughput, you can switch between then once every 24 hours</p>
<div class="section" id="provision-mode">
<h2>Provision Mode<a class="headerlink" href="#provision-mode" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>default (10RCU/10WCU)</p></li>
<li><p>specify the number of reads/writes per seconds</p></li>
<li><p>need to plan capacity beforehand</p></li>
<li><p>pay for <strong>provision</strong> (not only used) read &amp; write capacity units</p></li>
<li><p>option to setup autoscaling of throughput to meet demand (specify minimum and maximum capacity units and target utilization - required capacity units number is calculated based on target utilization percentage)</p></li>
<li><p>limits can be exceeded temporarily using <strong>Burst Capacity</strong></p></li>
<li><p>if Burst Capacity consumed, <code class="docutils literal notranslate"><span class="pre">ProvisionedThroughtputExceededException</span></code> is raised - in this case retry is needed to store/read data</p></li>
</ul>
</div>
<div class="section" id="on-demand-mode">
<h2>On-Demand Mode<a class="headerlink" href="#on-demand-mode" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>automatically scale read/writes</p></li>
<li><p>no capacity planning</p></li>
<li><p>pay for what you use, more often more expensive</p></li>
<li><p>no throttle - pay for everything you want to do</p></li>
<li><p>you are charged for reads/writes that you use in terms of RRU Read Request Units/WRU Write Request Units (RRU = RCU, WRU = WCU)</p></li>
<li><p>2.5x more expensive than provisioned capacity</p></li>
<li><p>use cases:</p>
<ul>
<li><p>unknown workloads,</p></li>
<li><p>unpredictable application traffic,</p></li>
<li><p>quick data migration on start (very high number of writes in short time - you dont need to set very high WCU capacity for 24 hours)</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="capacity-units">
<h1>Capacity Units<a class="headerlink" href="#capacity-units" title="Permalink to this heading">#</a></h1>
<div class="section" id="read-capacity-units-throughput-for-reads">
<h2>Read Capacity Units - throughput for reads<a class="headerlink" href="#read-capacity-units-throughput-for-reads" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>1 RCU = 1 strongly consistent read or 2 eventually consistent reads per second for an item up to 4KB in size</p></li>
<li><p>example = 7 strongly consistent read per second, each 2.7KB in size = 7 * ROUNDUP(2.7/4) = 7RCU</p></li>
<li><p>example = 11 eventually consistent  reads per second for an item 3.7KB in size = 11/2 * ROUNDUP(3.7/4) = 5.5RCU</p></li>
</ul>
</div>
<div class="section" id="write-capacity-units-throughput-for-writes">
<h2>Write Capacity Units - throughput for writes<a class="headerlink" href="#write-capacity-units-throughput-for-writes" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>1 WCU = 1 write per second for an item up to 1KB in size</p></li>
<li><p>items larger than 1KB, more WCUs are consumed</p></li>
<li><p>example = 7 items per second, each 2.7KB in size =&gt; 7*ROUNDUP(2.7/1) = 21WCU</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{warning}delete</span> <span class="pre">operations</span> <span class="pre">on</span> <span class="pre">nonexistent</span> <span class="pre">items</span> <span class="pre">consumes</span> <span class="pre">one</span> <span class="pre">write</span> <span class="pre">capacity</span> <span class="pre">unit</span></code></p></li>
</ul>
</div>
</div>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By https://github.com/michalgromiec<br/>
  
      &copy; Copyright .<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>